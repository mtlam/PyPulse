
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>SinglePulse Class &#8212; PyPulse 0.0.1 documentation</title>
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Calibrator Class" href="calibrator.html" />
    <link rel="prev" title="Archive Class" href="archive.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="calibrator.html" title="Calibrator Class"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="archive.html" title="Archive Class"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">PyPulse 0.0.1 documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">SinglePulse Class</a><ul>
<li><a class="reference internal" href="#methods">Methods</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="archive.html"
                        title="previous chapter">Archive Class</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="calibrator.html"
                        title="next chapter">Calibrator Class</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/singlepulse.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="toctree-wrapper compound">
</div>
<div class="section" id="singlepulse-class">
<h1>SinglePulse Class<a class="headerlink" href="#singlepulse-class" title="Permalink to this headline">¶</a></h1>
<p>The <em>SinglePulse</em> class handles an individual pulse data array.</p>
<dl class="class">
<dt id="SinglePulse">
<em class="property">class </em><code class="descname">SinglePulse</code><span class="sig-paren">(</span><em>data</em><span class="optional">[</span>, <em>mpw=None</em>, <em>ipw=None</em>, <em>opw=None</em>, <em>prepare=False</em>, <em>align=None</em>, <em>period=None</em>, <em>windowsize=None</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#SinglePulse" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data</strong> (<em>list/numpy.ndarray</em>) – Data array.</li>
<li><strong>mpw</strong> (<em>list/numpy.ndarray</em>) – Indices of the main-pulse window</li>
<li><strong>ipw</strong> (<em>list/numpy.ndarray</em>) – Indices of the inter-pulse window</li>
<li><strong>opw</strong> (<em>list/numpy.ndarray</em>) – Indices of the off-pulse window</li>
<li><strong>prepare</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Run <a class="reference internal" href="#interpulse_align" title="interpulse_align"><code class="xref py py-func docutils literal notranslate"><span class="pre">interpulse_align()</span></code></a></li>
<li><strong>align</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – Rotate the pulse by this amount in phase bin units.</li>
<li><strong>period</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – Provide pulse period.</li>
<li><strong>windowsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Overrides mpw, ipw, opw. Defines an off-pulse window of a given size about the minimum-integral region.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sp</span> <span class="o">=</span> <span class="n">SinglePulse</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">windowsize</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span> <span class="c1">#will auto-calculate an offpulse region of length 256 bins</span>
<span class="k">print</span> <span class="n">sp</span><span class="o">.</span><span class="n">getFWHM</span><span class="p">()</span> <span class="c1">#prints the FWHM of the pulse</span>
<span class="k">print</span> <span class="n">sp</span><span class="o">.</span><span class="n">getSN</span><span class="p">()</span> <span class="c1">#prints a crude S/N of the pulse</span>
<span class="k">print</span> <span class="n">sp</span><span class="o">.</span><span class="n">fitPulse</span><span class="p">(</span><span class="n">template_array</span><span class="p">)[</span><span class="mi">5</span><span class="p">]</span> <span class="c1">#prints a better S/N of the pulse using a template array</span>
</pre></div>
</div>
<div class="section" id="methods">
<h2>Methods<a class="headerlink" href="#methods" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="interpulse_align">
<code class="descname">interpulse_align</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#interpulse_align" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate the pulse such that the main pulse is at phase=0.25 and the interpulse is at phase = 0.75.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="center_align">
<code class="descname">center_align</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#center_align" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate the pulse such that the peak is in the center.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="normalize">
<code class="descname">normalize</code><span class="sig-paren">(</span><span class="optional">[</span><em>area=False</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalize the pulse so that the peak has a value of 1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>area</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Normalize the pulse so that the area has a value of 1.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="getFWHM">
<code class="descname">getFWHM</code><span class="sig-paren">(</span><span class="optional">[</span><em>simple=False</em>, <em>timeunits=True</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#getFWHM" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the full width at half maximum of the main component of the pulse.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">FWHM, <em>float</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="getWeff">
<code class="descname">getWeff</code><span class="sig-paren">(</span><span class="optional">[</span><em>sumonly=False</em>, <em>timeunits=True</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#getWeff" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the effective width of the pulse.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">W_eff, <em>float</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="getSN">
<code class="descname">getSN</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#getSN" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a crude signal-to-noise ratio as the maximum of the data array divided by the off-pulse RMS noise.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">S/N, <em>float</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="remove_baseline">
<code class="descname">remove_baseline</code><span class="sig-paren">(</span><span class="optional">[</span><em>save=True</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#remove_baseline" title="Permalink to this definition">¶</a></dt>
<dd><p>Subtract the baseline of the pulse so that it will be set to zero mean.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>save</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Replace the data array with the rotated versions.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">subtracted_array, <em>numpy.ndarray</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="calcOffpulseWindow">
<code class="descname">calcOffpulseWindow</code><span class="sig-paren">(</span><span class="optional">[</span><em>windowsize=None</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#calcOffpulseWindow" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate an offpulse window automatically by finding where the area under the curve is minimized, i.e., where</p>
<div class="math notranslate nohighlight">
\[\min \sum_{i=i_0}^{i_0+N} U(\phi_i)\]</div>
<p>is satisfied. The template (or profile) shape as a function of phase is <span class="math notranslate nohighlight">\(U(\phi)\)</span>, <span class="math notranslate nohighlight">\(i_0\)</span> is the initial index and <span class="math notranslate nohighlight">\(N\)</span> is the length of the window. Returns the offpulse window indices.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>windowsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Window size (<span class="math notranslate nohighlight">\(N\)</span>) in bin units. The default is the length of the data array divided by 8.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">opw, <em>numpy.ndarray</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="getMainpulse">
<code class="descname">getMainpulse</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#getMainpulse" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the main-pulse intensities.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">mpw, <em>numpy.ndarray</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="getInterpulse">
<code class="descname">getInterpulse</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#getInterpulse" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the inter-pulse intensities.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">mpw, <em>numpy.ndarray</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="getOffpulse">
<code class="descname">getOffpulse</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#getOffpulse" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the off-pulse intensities.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">mpw, <em>numpy.ndarray</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="getAllpulse">
<code class="descname">getAllpulse</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#getAllpulse" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the main-pulse, inter-pulse, and off-pulse intensities.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">mpw, <em>numpy.ndarray</em>, ipw, <em>numpy.ndarray</em>, opw, <em>numpy.ndarray</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="getMainpulseACF">
<code class="descname">getMainpulseACF</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#getMainpulseACF" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the autocorrelation function of the main-pulse.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">mpacf, <em>nump.array</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="getInterpulseACF">
<code class="descname">getInterpulseACF</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#getInterpulseACF" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the autocorrelation function of the inter-pulse.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">ipacf, <em>nump.array</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="getOffpulseACF">
<code class="descname">getOffpulseACF</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#getOffpulseACF" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the autocorrelation function of the off-pulse.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">opacf, <em>nump.array</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="getAllpulseACF">
<code class="descname">getAllpulseACF</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#getAllpulseACF" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the main-pulse, inter-pulse, and off-pulse autocorrelation functions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">mpacf, <em>numpy.ndarray</em>, ipacf, <em>numpy.ndarray</em>, opacf, <em>numpy.ndarray</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="getOffpulseNoise">
<code class="descname">getOffpulseNoise</code><span class="sig-paren">(</span><span class="optional">[</span><em>mean=False</em>, <em>full=False</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#getOffpulseNoise" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the root-mean-square (RMS) of the off-pulse intensities.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mean</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Calculate the mean value of the off-pulse intensities instead of the roo-mean-square.</li>
<li><strong>full</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Return both the off-pulse mean and RMS.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">noise, <em>float</em> (if <code class="docutils literal notranslate"><span class="pre">full</span></code> is True then return two floats, the mean and the RMS)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="getOffpulseZCT">
<code class="descname">getOffpulseZCT</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#getOffpulseZCT" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a zero-crossing test of the offpulse noise. The expected number of zero crossings for <span class="math notranslate nohighlight">\(N\)</span> samples of white noise is <span class="math notranslate nohighlight">\((N-1)/2 \pm \sqrt{(N-1)/2}\)</span>. If the number is within <span class="math notranslate nohighlight">\(3\sigma\)</span> of the expectation, return True, otherwise, return False.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">success, test_statistic, count</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="fitPulse">
<code class="descname">fitPulse</code><span class="sig-paren">(</span><em>template</em><span class="optional">[</span>, <em>fixedphase=False</em>, <em>rms_baseline=None</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#fitPulse" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform the template-matching procedure of Taylor 1992 in the Fourier domain. Matched filtering assumes that the data profile <span class="math notranslate nohighlight">\(I(t)\)</span> is a scaled and shifted version of a template profile <span class="math notranslate nohighlight">\(U(t)\)</span>, plus additive noise, i.e.,</p>
<div class="math notranslate nohighlight">
\[I(t) = b U(t - \tau) + n(t)\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is time (in pulse phase units), <span class="math notranslate nohighlight">\(n(t)\)</span> is the additive noise, and <span class="math notranslate nohighlight">\(b\)</span> and <span class="math notranslate nohighlight">\(\tau\)</span> are the scale factor and shift, respectively. PyPulse performs this fit in terms of phase but these numbers can be translated into absolute arrival times.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>template</strong> (<em>list/numpy.ndarray/SinglePulse</em>) – Template shape to fit to the data array.</li>
<li><strong>fixedphase</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Return only the signal-to-noise with the template shape fixed in its phase.</li>
<li><strong>rms_baseline</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – Provide a different value of the off-pulse root-mean-square noise.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">TOA from cross-correlation function (tauccf), TOA from template matching procedure (tauhat), scale factor (bhat), error on TOA (sigma_Tau), error on scale factor (sigma_b), signal-to-noise ratio (snr), cross-correlation coefficient (rho)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">include a goodness-of-fit flag as a measure of the residuals</p>
</div>
<dl class="function">
<dt id="shiftit">
<code class="descname">shiftit</code><span class="sig-paren">(</span><em>shift</em><span class="optional">[</span>, <em>save=False</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#shiftit" title="Permalink to this definition">¶</a></dt>
<dd><p>Shift the pulse by some number of phase bins</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>shift</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – Rotate the pulse in bin units.</li>
<li><strong>save</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Replace the data array with the rotated versions.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="spline_smoothing">
<code class="descname">spline_smoothing</code><span class="sig-paren">(</span><span class="optional">[</span><em>lam=None</em>, <em>**kwargs</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#spline_smoothing" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterative cubic spline interpolation for smooth template generation. The spline-generation algorithm is defined by D.S.G. Pollock 1999 (Smoothing with Cubic Splines), in which the cubic spline preserves slope and curvature through each of the control points, i.e., it minimizes the function:</p>
<div class="math notranslate nohighlight">
\[L = \lambda \chi^2 + (1-\lambda) \int \left[S^{''}(\phi)\right]^2 d\phi\]</div>
<p>where <span class="math notranslate nohighlight">\(\chi^2\)</span> is the sum of the residuals (“chi-squared”), the integral is the curvature of the spline over all of pulse phase <span class="math notranslate nohighlight">\(\phi\)</span>, and <span class="math notranslate nohighlight">\(\lambda\)</span> represents the paramter (“lam”) that weights the importance of the two components.</p>
<p>Control points (knots) are generated iteratively. Polynomials up to quartic order are fit over the data array. If a quadratic well fits the data, then return without adding a knot, else subdivide the data in half and return the midpoint as a knot. The data array is continuously divided into two halves up to some minimum separation (default=16). In locations <span class="math notranslate nohighlight">\(\phi_i\)</span> where a knot is decided to be placed, the phase bins closest to that knot location are fit by a cubic <span class="math notranslate nohighlight">\(f(\phi\)</span> and the knot is placed at <span class="math notranslate nohighlight">\((\phi_i,f(\phi))\)</span>. After the initial knots locations are chosen, run the cubic spline interpolation as described before. If there is a location where a new knot will help the fit (the residuals must be greater than 4 times the RMS and the location in phase must be 3 times the off-pulse RMS, i.e., the current spline model fails there and it must be a location where actual pulse intensity is present), include that knot and re-run the cubic spline interpolation until the residuals RMS is low.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>lam</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – The lambda parameter that determines the relative weight of fitting through the knots and minimizing the curvature of the spline. Can take values from (0,1], where 1 = fit exactly through the knots and 0 = minimized curvature of the spline. If not provided, it is calculated as 1-(off-pulse rms)^2.</li>
<li><strong>**kwargs</strong> – <p>Additional arguments to pass to <code class="xref py py-func docutils literal notranslate"><span class="pre">utils.subdivide()</span></code>.</p>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">template, <em>numpy.ndarray</em></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="component_fitting">
<code class="descname">component_fitting</code><span class="sig-paren">(</span><span class="optional">[</span><em>mode='gaussian'</em>, <em>nmax=10</em>, <em>full=False</em>, <em>minamp=None</em>, <em>alpha=0.05</em>, <em>allownegative=False</em>, <em>verbose=False</em>, <em>save=False</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#component_fitting" title="Permalink to this definition">¶</a></dt>
<dd><p>Iteratively fits a total of nmax components to a pulse profile. The iteration will end when the <span class="math notranslate nohighlight">\(\chi_r^2\)</span> is minimized.</p>
<p>If mode == ‘gaussian’, will fit components of the form</p>
<div class="math notranslate nohighlight">
\[f(\phi) = A \exp\left[-\frac{1}{2}\left(\frac{\phi-\mu}{\sigma}\right)\right]\]</div>
<p>where <span class="math notranslate nohighlight">\(\phi\)</span> is the pulse phase, <span class="math notranslate nohighlight">\(A\)</span> is the component amplitude, <span class="math notranslate nohighlight">\(\mu\)</span> is the mean pulse phase, and <span class="math notranslate nohighlight">\(\sigma\)</span> is the component width.</p>
<p>If mode == ‘vonmises’, will fit components of the form</p>
<div class="math notranslate nohighlight">
\[f(\phi) = A \frac{\exp\left[\kappa \cos(\phi-\mu)\right]}{2\pi I_0(\kappa)}\]</div>
<p>where again <span class="math notranslate nohighlight">\(\phi\)</span> is the pulse phase and <span class="math notranslate nohighlight">\(A\)</span> is the component amplitude, <span class="math notranslate nohighlight">\(\mu\)</span> is the mean pulse phase, and <span class="math notranslate nohighlight">\(1/\kappa\)</span> is the analogous to the component width (squared) of a Gaussian, <span class="math notranslate nohighlight">\(\sigma^2\)</span>. The function <span class="math notranslate nohighlight">\(I_0\)</span> is the modified Bessel function of order 0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The function to fit, can choose: ‘gaussian’, ‘vonmises’.</li>
<li><strong>nmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Maximum number of components to test.</li>
<li><strong>full</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Return both the off-pulse mean and RMS.</li>
<li><strong>minamp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – If all of the profile residuals are less than the fraction of the maximum set by minamp, then return. For example, if minamp is 0.05, once all profile residuals are less than 5% of the maximum, return.</li>
<li><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – F-test significance value. For example, if alpha is 0.05, then new components are kept if 1 - 0.05 = 95% significant.</li>
<li><strong>allownegative</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – If true, allow negative-amplitude components in the fitting</li>
<li><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Print when each component is fit</li>
<li><strong>plot</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – If true, show a plot of the fit, with the components</li>
<li><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – If provided, save the plot above to the filename.</li>
<li><strong>save</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – If true, replace the data array with the smoothed profile.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">template, <em>numpy.ndarray</em> (if <code class="docutils literal notranslate"><span class="pre">full</span></code> is True then the template, the fit of the parameters, and the number of parameters)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="gaussian_smoothing">
<code class="descname">gaussian_smoothing</code><span class="sig-paren">(</span><span class="optional">[</span><em>nmax=10</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#gaussian_smoothing" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs <a class="reference internal" href="#component_fitting" title="component_fitting"><code class="xref py py-func docutils literal notranslate"><span class="pre">component_fitting()</span></code></a> with mode = ‘gaussian’</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>nmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Maximum number of components to test.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">template, <em>numpy.ndarray</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="vonmises_smoothing">
<code class="descname">vonmises_smoothing</code><span class="sig-paren">(</span><span class="optional">[</span><em>nmax=10</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#vonmises_smoothing" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs <a class="reference internal" href="#component_fitting" title="component_fitting"><code class="xref py py-func docutils literal notranslate"><span class="pre">component_fitting()</span></code></a> with mode = ‘vonmises’</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>nmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Maximum number of components to test.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">template, <em>numpy.ndarray</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="getPeriod">
<code class="descname">getPeriod</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#getPeriod" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the pulse period.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">period, <em>float</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="getNbin">
<code class="descname">getNbin</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#getNbin" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of phase bins.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">nbins, <em>int</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="getTbin">
<code class="descname">getTbin</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#getTbin" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the time per phase bin</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">t, <em>float</em></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="plot">
<code class="descname">plot</code><span class="sig-paren">(</span><span class="optional">[</span><em>show=True</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple plot of the pulse.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>show</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Show the plot.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="plot_windows">
<code class="descname">plot_windows</code><span class="sig-paren">(</span><span class="optional">[</span><em>show=True</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#plot_windows" title="Permalink to this definition">¶</a></dt>
<dd><p>Diagnostic plot of the main-, inter-, and off-pulse regions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>show</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Show the plot.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="calibrator.html" title="Calibrator Class"
             >next</a> |</li>
        <li class="right" >
          <a href="archive.html" title="Archive Class"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">PyPulse 0.0.1 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, Michael T. Lam.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>